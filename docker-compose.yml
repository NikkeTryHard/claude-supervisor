# Claude Supervisor - Development Environment
#
# Usage:
#   docker compose up -d      # Start container
#   docker compose exec app bash  # Shell into container
#   docker compose down       # Stop container

services:
  app:
    build: .
    container_name: claude-supervisor
    stdin_open: true
    tty: true
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      - GEMINI_API_KEY=${GEMINI_API_KEY:-}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
      - RUST_LOG=info
      - TERM=xterm-256color
      - LANG=C.UTF-8
      - CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC=1
    volumes:
      # Claude Code settings - writable so Claude can update them
      - ~/.claude/CLAUDE.md:/home/claude/.claude/CLAUDE.md:ro
      - ./docker/claude-settings.json:/home/claude/.claude/settings.json
      - ~/.claude/skills:/home/claude/.claude/skills:ro
      # Note: ~/.claude.json NOT mounted - container manages its own trust state
      # Supervisor config (editable)
      - ./config.example.toml:/home/claude/.config/claude-supervisor/config.toml
      # Mount current project for testing
      - .:/home/claude/project
    ports:
      - "3000:3000"  # Dashboard
    working_dir: /home/claude/project
    entrypoint: ["bash"]
